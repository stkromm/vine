package vine.application;

import java.util.logging.Level;
import java.util.logging.Logger;

import vine.display.Display;
import vine.graphics.Graphics;
import vine.input.Input;
import vine.window.Window;
import vine.window.WindowCreationException;

/**
 * @author Steffen
 *
 */
public class PlatformDependencyResolver {

    private PlatformDependencyResolver() {

    }

    /**
     * @return The platform dependent implementation of window.
     */
    public static Window getPlatformWindow(Display display) {
        try {
            Window window  = (Window) ClassLoader.getSystemClassLoader().loadClass("vine.platform.lwjgl3.GLFWWindow")
                    .newInstance();
            try {
                window.init(display);
            } catch (WindowCreationException e) {
                logger.error("Failed to create the application window", e);
                System.exit(1);
            }
            return 
        } catch (InstantiationException | IllegalAccessException | ClassNotFoundException e) {
            Logger.getGlobal().log(Level.SEVERE, "Auto-generated catch block", e);
            return null;
        }
    }

    /**
     * @return The platform dependent implementation of display.
     */
    public static Display getDisplay() {
        try {
            return (Display) ClassLoader.getSystemClassLoader().loadClass("vine.platform.lwjgl3.GLFWDisplay")
                    .newInstance();
        } catch (InstantiationException | IllegalAccessException | ClassNotFoundException e) {
            Logger.getGlobal().log(Level.SEVERE, "Auto-generated catch block", e);
            return null;
        }
    }

    /**
     * @return The platform dependent implementation of graphics.
     */
    public static Graphics getGraphics() {
        try {
            return (Graphics) ClassLoader.getSystemClassLoader().loadClass("vine.platform.lwjgl3.GLGraphics")
                    .newInstance();
        } catch (InstantiationException | IllegalAccessException | ClassNotFoundException e) {
            Logger.getGlobal().log(Level.SEVERE, "Auto-generated catch block", e);
            return null;
        }
    }

    /**
     * @param context
     * @return The platform dependent implementation of input.
     */
    public static Input getInput(long context) {
        try {
            Input input = (Input) ClassLoader.getSystemClassLoader().loadClass("vine.platform.lwjgl3.GLFWInput")
                    .newInstance();
            input.listenToWindow(context);
            return input;
        } catch (InstantiationException | IllegalAccessException | ClassNotFoundException e) {
            Logger.getGlobal().log(Level.SEVERE, "Auto-generated catch block", e);
            return null;
        }
    }
}
